task_description: |
  Task: Implement a handful of advanced number endpoints, focusing on the concrete examples
  used in tests.

  Instructions:
  Keep the logic clear and straightforward. For each endpoint below, match the behavior shown
  in the test examples.

  Requirements (as tested):

  - GET /adv/powmod
    Behavior (as tested):
    - Computes (a**b) % m for small integer inputs.
    - For example, tests call /adv/powmod with (2,5,7) and (5,3,13) and compare the
      "result" field to Python's pow(a, b, m).

  - GET /adv/modinv
    Behavior (as tested):
    - Returns {'result': x} where x is in [0, m-1] and (a*x) % m == 1 when the inverse
      exists (e.g. a=3, m=11 → result=4).
    - Returns HTTP 400 when no inverse exists (e.g. a=6, m=9).

  - GET /adv/primes_segment
    Behavior (as tested):
    - For format=json: respond {"result": [primes in [L,R]]}.
      Example: L=10, R=50, format=json → {"result": [11,13,17,19,23,29,31,37,41,43,47]}.
    - For format=csv: respond text/csv with header "prime" and one prime per line.
      Example: L=2, R=30, format=csv → header "prime" then 2,3,5,7,11,13,17,19,23,29.

  - GET /adv/stats
    Behavior (as tested):
    - For the list "2,4,4,4,5,5,7,9", returns a JSON object containing "mean", "variance",
      and "stddev". The mean is 5, while variance and stddev are required only to be
      non-negative values.

  - GET /adv/gcd_array
    Behavior (as tested):
    - For "54,24,90", returns {"result": 6} (the gcd of all numbers).
    - Returns HTTP 400 when nums is empty (nums="").

  Example documents you might need to fix:
  - server/middleware/validate.js
  - server/routes/advanced.js
  - server/services/calculator.js

  Notes:
  - Tests focus on the concrete examples listed above rather than every possible invalid input
    or performance edge case.

difficulty: medium
category: Feature
tags: [node, express, algorithms, number theory]
parser_name: pytest
