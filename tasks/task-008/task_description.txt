task_description: |
  Task: Set up three analysis endpoints with strict whole-number checks. Keep the logic clear and broad so it matches test expectations exactly.

  Instructions:
  Build new endpoints that return HTTP 400 whenever the input is invalid. Aim for accuracy and use straightforward, practical methods.

  Requirements (as tested):

  1. GET /adv/prime_factors
     Query: n
     - n must be an integer and at least 2.
     Behavior:
     - Return the prime-factor list of n in ascending order, with repeats included.  
       Example: 60 → [2,2,3,5].
     - Invalid input (letters, decimals, or values below 2) must produce HTTP 400.

  2. GET /adv/rolling_median
     Query: nums, k
     - nums: a comma-separated list of whole numbers, no spaces or decimals. Must not be empty.
     - k: an odd integer where k ≥ 1 and k does not exceed the length of nums.
     Behavior:
     - For each sliding window of size k, sort the window and pick the middle element.
     - Return the list of these medians. Results may be decimals, though whole-number inputs will result in whole medians.
     Example:
       nums = 1,3,2,6,4 and k = 3  
       Windows: [1,3,2], [3,2,6], [2,6,4]  
       Medians: [2,3,4]
     - Invalid input (even k, k too large, malformed nums) must produce HTTP 400.

  3. GET /adv/unique_mode
     Query: nums
     - nums: a comma-separated list of whole numbers with no spaces or decimals. Must not be empty.
     Behavior:
     - If exactly one value appears most often, return {"result": x}.
     - If there is a tie for highest frequency, or every value appears once, return HTTP 400.
     - Any invalid input also returns HTTP 400.

  Validation helpers:
  - Only allow whole numbers. No empty lists, missing values, or text.
  - Use a shared validator that can handle single numbers and number lists.

  Files you may need to modify:
  - server/middleware/validate.js
  - server/routes/advanced.js
  - server/services/calculator.js

  Notes:
  - Prime factorization using trial division up to sqrt(n) is fast enough for numbers up to 10^7.
  - Rolling median with simple sorting per window (O(nk log k)) is acceptable.
  - Always return HTTP 400 for bad inputs; test cases only check the status code.

  Anti-cheating guidance:
  - Do not rely on fixed values; tests will change input.
  - Use basic, consistent logic without timing tricks or shortcuts.

difficulty: hard
category: Feature
tags: [node, express, algorithms]
parser_name: pytest
