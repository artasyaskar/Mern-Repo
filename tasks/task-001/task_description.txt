task_description: |
  Task: Implement and adjust advanced numeric endpoints with precise calculations
  Instructions:
  Requirements (as tested):
  - POST /adv/stats
    - Body: { 'numbers': array of numbers, 'ddof'?: integer } (ddof defaults to 1)
    - Validate: non-empty array of finite numbers; return 400 if n - ddof <= 0
    - Return JSON: { mean, median, mode, variance, stddev }
    - Use sample statistics with denominator (n - ddof)
    - Handle numeric stability for values up to 1e9

  - GET /adv/primes
    - Query: n (int), optional start (int â‰¥ 2), optional format in {json, csv}
    - Return primes in [start, n] if start provided, else [2, n]
    - format=json: { "result": number[] }
    - format=csv: text/csv with header "prime" and one prime per line
    - Validation: integers only; return 400 if start > n
    - Performance: n=20000 with format=json must complete < 2s

  - GET /adv/gcd and GET /adv/lcm
    - Inputs must be integers (return 400 for decimals)
    - Results must be non-negative (e.g., gcd(-8,12)=4; lcm(-4,6)=12)

  Notes:
  - Modify only: server/routes/advanced.js, server/services/calculator.js, server/middleware/validate.js

difficulty: hard
category: Feature
tags: [node, express, algorithms]
parser_name: pytest
