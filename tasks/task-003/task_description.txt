task_description: |
  Task: Calendar intelligence - ISO weeks and business-day metrics
  Instructions:
  Create new endpoints that figure out ISO week info - while managing date range summaries - with strict validation inside. Rely on clear logic to make sure data matches expectations every round.
  Requirements (as tested):
  - POST /adv/date-metrics
    Body (JSON): {
      start: dates shown as 2023-10-15,
      completion day: something written as 2023-12-31
      Take holidays - skip extras; just write dates such as 2025-12-25, duplicates okay
    }
    Behavior:
    - Look at what's been added. Get rid of it if:
      - dates don’t follow the year-month-day pattern, or simply can’t exist in any real calendar
      start → end
      vacation days displayed without being written out as YYYY-MM-DD
      {"instruction": "Work out what's needed, then reply with a JSON containing these fields:"}
    - d-days total means the full count of days from beginning to finish, including the first day as well as the last one
    - business_days: counts weekdays Mon through Fri in the range, leaving out holiday-marked dates
    - weeks_iso: a collection of unique ISO week labels across the period, such as ["2025-W01"], sorted starting from the oldest moving toward the newest
    - start_of_week: it's the Monday (YYYY-MM-DD) from the ISO week containing start
      end_of_week: Sunday’s day (YYYY-MM-DD), based on the ISO week holding end

  - GET /adv/iso-week
    Query: date=YYYY-MM-DD
    Behavior:
    Look at the date - if it’s off, return a 400.
    { "isoYear": number, however "isoWeek": number, also "label": "YYYY-Www" } using ISO-8601 calendar - weeks begin each Monday.

  Notes:
  - Tweak this stuff: server/routes/advanced.js, also check server/utils/date.js. Keep things working right, don't break tests.

difficulty: hard
category: Feature
tags: [node, express, dates, algorithms]
parser_name: pytest
